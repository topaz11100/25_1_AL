## Method 2

본 문제는 내림차순 배열을 분산의 합이 최소인 그룹으로 분할하는 문제이다

보조정리 1
내림차순 정렬 배열 $s_{i}$ 에 대해
분산의 합이 최소인 분할에 대해
분할의 모든 원소는 데이터가 연속인 그룹이다

증명
귀류법으로 증명한다
내림차순 정렬 배열 $s_{i}$ 에 대해 분산의 합이 최소인 분할이지만
원소가 데이터의 연속이 아닌 분할을 $G^{*}$ 라 하자

그룹 하나의 분산
$$
Var(G_{i}) = \frac{1}{|G_{i}|}\sum_{x \in G_{i}} {(x-E[G_{i}])^{2}}
$$

분할의 그룹 분산 합
$$
L = \sum_{g \in G^{*}} Var(g) = \sum_{g \in G^{*}} \frac{1}{|g|}\sum_{x \in g} {(x - E[g])^{2}}
$$

$G^{*}$ 에는  $i < j < k$ 인 $i,j,k$ 와 $G_{1}, G_{2} \in G^{*}$ 인 $G_{1}, G_{2}$ 에 대해
$s_{i}, s_{k} \in G_{1}, s_{j} \in G_{2}$ 인 $s_{i}, s_{j}, s_{k}$ 가 존재한다
내림차순이므로 $s_{i} \ge s_{j} \ge s_{k}$ 이다

$$
|s_{i} - E[G_{2}]| \ge |s_{i} - E[G_{1}]|
$$

$$
|s_{j} - E[G_{2}]| \ge |s_{k} - E[G_{1}]|
$$

$$
|s_{k} - E[G_{1}]| \ge |s_{i} - E[G_{1}]|
$$

따라서 내림차순 정렬 배열 $s_{i}$ 에 대해
분산의 합이 최소인 분할에 대해
분할의 모든 원소는 데이터가 연속인 그룹이다

길이 $n$ 인 내림차순 정렬 배열 $A$ 에 대해 아래와 같은 점화식을 생각할 수 있다

$$
V(i, k) : \text{ A[0]부터 A[i]까지의 데이터를 k개 최적 분할했을 때의 분산 최소 값 }
$$

분할의 모든 원소는 데이터가 연속인 그룹이므로
마지막 그룹이 떨어지는 형태로 분할에 관한 점화식을 세울 수 있다
$t<i$ 에 대해 `A[0:i]` 의 최적 분할의 마지막 그룹 시작 인덱스가 `t`라고 하자


$$
V(i, k) = min_{t < i}(V(t, k-1) + Var(A[t+1:i]))
$$